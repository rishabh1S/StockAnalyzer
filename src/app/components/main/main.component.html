<header class=" inset-x-0 top-0">
    <nav [ngClass]="{'drop-shadow-md': shouldApplyDropShadow}"
        class="bg-white fixed w-full z-20 top-0 left-0 border-b border-gray-200" aria-label="Global">
        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-1">
            <a href="#" class="flex-none items-center mx-4">
                <svg width="100" height="60" viewBox="0 0 369.89473684210526 206.53620445271827">
                    <defs>
                        <linearGradient id="SvgjsLinearGradient1043">
                            <stop id="SvgjsStop1044" stop-color="#2B4BDA" offset="0" />
                            <stop id="SvgjsStop1045" stop-color="#9333EA" offset="1" />
                        </linearGradient>
                    </defs>
                    <g featurekey="monogramFeature-0"
                        transform="matrix(4.927971365791381,0,0,4.927971365791381,-7.391463582316099,-89.12700092221144)"
                        fill="url(#SvgjsLinearGradient1043)">
                        <path
                            d="M12.236 49.61 c0 1.3413 -1.0929 2.4342 -2.4342 2.4342 l-8.3017 0 l0 -1.2971 l8.3017 0 c0.62376 0 1.1371 -0.50783 1.1371 -1.1371 l0 -31.524 l1.2971 0 l0 31.524 z M14.223 49.483000000000004 c0 2.5281 -2.0534 4.5869 -4.5814 4.5814 l-8.1417 0 l0 -1.2971 l8.1417 0 c1.8105 0 3.2843 -1.4738 3.2843 -3.2843 l0 -31.397 l1.2971 0 l0 31.397 z M16.216 50.0904 c0 3.2677 -2.6606 5.9282 -5.9283 5.9282 l-8.7875 0 l0 -1.2971 l8.7875 0 c2.5557 0 4.6312 -2.081 4.6312 -4.6311 l0 -32.004 l1.2971 0 l0 32.004 z M18.203 50.4324 c0 4.1509 -3.3781 7.5288 -7.5288 7.5288 l-9.1684 0 l0 -1.2971 l9.1684 0 c3.4333 0 6.2316 -2.793 6.2316 -6.2316 l0 -32.346 l1.2971 0 l0 32.346 z M18.893 18.086 l1.2972 -0.000058594 l0 32.776 c0 5.0396 -4.0957 9.135 -9.135 9.135 l-9.5492 0 l0 -1.2971 l9.5492 0 c4.322 0 7.8378 -3.5161 7.8378 -7.8378 l0 -32.776 z" />
                    </g>
                    <g featurekey="nameFeature-0"
                        transform="matrix(2.1624196066567634,0,0,2.1624196066567634,106.59377569261468,49.375803933432366)"
                        fill="#000">
                        <path
                            d="M16.211 19.922 l5.625 0 l0 20.078 l-5.332 0 l-0.13672 -2.4219 c-1.4063 1.7773 -3.6328 2.8125 -6.3867 2.8125 c-4.8242 0 -7.4805 -2.5195 -7.4805 -6.9531 l0 -13.516 l5.6445 0 l0 12.305 c0 2.6563 1.6602 3.6328 3.6133 3.6328 c2.3242 0 4.4336 -1.1719 4.4531 -4.8633 l0 -11.074 z M34.8873515625 40.39063 c-6.0547 0 -10.781 -2.9102 -11.641 -8.2031 l6.0547 -1.3867 c0.39063 3.1641 2.7148 4.8047 5.8203 4.8047 c2.3828 0 4.2773 -1.0547 4.2578 -3.4375 c-0.019531 -2.6563 -3.1445 -3.4961 -6.582 -4.5508 c-4.1406 -1.2891 -8.5742 -2.8125 -8.5742 -8.0078 c0 -5.2539 4.2969 -8.2227 9.9609 -8.2227 c4.9609 0 9.9609 2.0117 11.094 7.4219 l-5.6641 1.4063 c-0.52734 -2.8125 -2.4219 -4.043 -5.0781 -4.043 c-2.3633 0 -4.375 0.97656 -4.375 3.3008 c0 2.168 2.7734 2.8906 5.9766 3.8477 c4.2578 1.2891 9.2969 2.9297 9.2969 8.5547 c0 5.9961 -5.0195 8.5156 -10.547 8.5156 z M54.697640625 40 c-3.9063 0 -6.1328 -2.2656 -6.1328 -6.2695 l0 -9.4922 l-3.9453 0 l0 -4.3164 l1.2695 0 c2.1289 0 3.3008 -0.82031 3.3008 -3.8281 l0 -2.6563 l5.0781 0 l0 6.4844 l4.1406 0 l0 4.3164 l-4.1406 0 l0 8.8867 c0 1.7969 0.87891 2.5977 2.3242 2.5977 l1.8164 0 l0 4.2773 l-3.7109 0 z M69.2337734375 40.39063 c-6.3867 0 -10.996 -3.8867 -10.996 -10.449 c0 -6.5234 4.5703 -10.41 10.996 -10.41 c6.4648 0 11.016 3.8867 11.016 10.41 c0 6.5625 -4.5703 10.449 -11.016 10.449 z M69.1747734375 35.918 c3.2617 0 5.4883 -2.3828 5.4883 -5.9766 s-2.2266 -5.9766 -5.4883 -5.9766 c-3.1445 0 -5.3516 2.3828 -5.3516 5.9766 s2.207 5.9766 5.3516 5.9766 z M90.6248125 40.37109 c-6.3086 0 -10.762 -4.1992 -10.762 -10.43 c0 -6.25 4.4531 -10.41 10.762 -10.41 c5.0781 0 8.8867 2.6367 9.8633 7.3828 l-5.1953 0.56641 c-0.625 -2.4023 -2.3633 -3.5156 -4.7266 -3.5156 c-3.0273 0 -5.0781 2.3828 -5.0781 5.9766 c0 3.5742 2.0508 5.9766 5.0781 5.9766 c2.3633 0 4.1016 -1.1328 4.7266 -3.5156 l5.1953 0.56641 c-0.97656 4.7461 -4.8828 7.4023 -9.8633 7.4023 z M114.9262890625 40 l-6.4648 -8.4375 l-1.1719 0 l0 8.4375 l-5.6836 0 l0 -30 l5.6836 0 l0 17.656 l1.0547 0 l6.3086 -7.7344 l6.3672 0 l-7.9102 9.3164 l8.6523 10.762 l-6.8359 0 z" />
                    </g>
                </svg>
            </a>
            <div class="hidden md:block relative flex-grow w-full md:w-auto md:mx-20 lg:mx-60 items-center"
                (click)="toggleDropdown()">
                <div class="absolute left-0 top-0 mt-3 mx-3 ">
                    <svg class="w-5 h-5 text-gray-500 flex items-center" aria-hidden="true" fill="currentColor"
                        viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                            clip-rule="evenodd"></path>
                    </svg>
                    <span class="sr-only">Search icon</span>
                </div>
                <form (submit)="searchStocks($event)">
                    <input #searchInput type="text" autocomplete="off" (focus)="toggleDropdown()"
                        class="border-none block w-full p-3 pl-10 text-sm text-gray-900 rounded-lg bg-gray-100 focus:bg-gray-50 focus:shadow-md focus:ring-0"
                        name="stockSearch" [formControl]="searchKeywords" placeholder="Search for stocks...">
                </form>
                <ul *ngIf="isDropdownOpen && searchResults"
                    class="dropdown absolute z-10 w-full mt-2 bg-white rounded shadow-md max-h-60 overflow-y-auto">
                    <li *ngFor="let result of searchResults; let i = index" [class.selected]="i === selectedIndex"
                        class="py-1 px-4 cursor-pointer hover:bg-blue-100 border-b border-gray-300"
                        (click)="selectResult(result['1. symbol'], selectedInterval); closeDropdown()">
                        <span class="text-base text-gray-700">{{ result['2. name'] }}</span>
                        <br>
                        <span class="font-medium text-xs text-gray-800">{{ result['1. symbol'] }} : </span>
                        <span class="text-gray-700 text-xs">{{ result['8. currency'] }} </span>
                        <span class="text-gray-500 text-xs">({{ result['4. region'] }})</span>
                    </li>
                </ul>
            </div>
            <div class="flex justify-end items-center mx-4">
                <div class="relative inline-flex items-center">
                    <div class="md:hidden flex items-center justify-center p-2 rounded-full hover:bg-gray-100">
                        <button type="button" class="flex" aria-controls="mobile-menu" aria-expanded="false"
                            (click)="toggleSearchIcon()">
                            <svg class="w-5 h-5 text-gray-500" aria-hidden="true" fill="currentColor"
                                viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                    d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="ml-4">
                        <button type="button" class="flex items-center justify-center gap-x-1.5 rounded-md bg-white"
                            id="menu-button" aria-expanded="true" aria-haspopup="true"
                            (click)="toggleProfileDropdown()">
                            <img class="h-8 w-auto" src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png"
                                alt="Logo">
                        </button>
                        <div class="absolute right-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"
                            role="menu" aria-orientation="vertical" aria-labelledby="menu-button" tabindex="-1"
                            [class.hidden]="!isProfileDropdownOpen">
                            <div class="py-1" role="none">
                                <a class="text-gray-700 block px-4 py-2 text-sm hover:cursor-pointer" role="menuitem"
                                    tabindex="-1" id="menu-item-1" (click)="switchAccount()">Switch Account</a>
                                <a href="#support" class="text-gray-700 block px-4 py-2 text-sm hover:cursor-pointer"
                                    role="menuitem" tabindex="-1" id="menu-item-1">Help and Support</a>
                                <a class="text-gray-700 block px-4 py-2 text-sm hover:cursor-pointer" role="menuitem"
                                    tabindex="-1" id="menu-item-2" (click)="logout()">Sign out</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div *ngIf="isSearchBarOpen" class="lg:hidden" role="dialog" aria-modal="true">
                <div
                    class="fixed inset-y-0 right-0 z-50 w-full overflow-y-auto bg-white px-6 py-6 sm:max-w-sm sm:ring-1 sm:ring-gray-900/10">
                    <div class="flex items-center justify-between">
                        <div class="relative flex-grow w-full md:w-auto md:mx-20 lg:mx-60 items-center"
                            (click)="toggleDropdown()">
                            <div class="absolute left-0 top-0 mt-3 mx-3">
                                <svg class="w-5 h-5 text-gray-500 flex items-center" aria-hidden="true"
                                    fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                                        clip-rule="evenodd"></path>
                                </svg>
                                <span class="sr-only">Search icon</span>
                            </div>
                            <form (submit)="searchStocks($event)" class="flex">
                                <input #searchInput type="text" autocomplete="off" (input)="toggleDropdown()"
                                    class="border-none block w-full p-3 pl-10 text-sm text-gray-900 rounded-lg bg-gray-100 focus:bg-gray-50 focus:shadow-md focus:ring-0"
                                    name="stockSearch" [formControl]="searchKeywords"
                                    placeholder="Search for stocks...">
                                <button class="absolute right-0 top-0 mt-3 mx-3 flex items-center"
                                    (click)="toggleSearchIcon(); clearSearch()">
                                    <span class="sr-only">Close Search Menu</span>
                                    <svg class="h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24"
                                        stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </form>
                            <ul *ngIf="isDropdownOpen && searchResults" class="dropdown z-10 w-full mt-2">
                                <li *ngFor="let result of searchResults; let i = index"
                                    [class.selected]="i === selectedIndex"
                                    class="py-1 px-4 cursor-pointer hover:bg-blue-100 border-b border-gray-300"
                                    (click)="selectResult(result['1. symbol'], selectedInterval); closeDropdown(); toggleSearchIcon()">
                                    <span class="text-base text-gray-700">{{ result['2. name'] }}</span>
                                    <br>
                                    <span class="font-medium text-xs text-gray-800">{{ result['1. symbol'] }} :
                                    </span>
                                    <span class="text-gray-700 text-xs">{{ result['8. currency'] }} </span>
                                    <span class="text-gray-500 text-xs">({{ result['4. region'] }})</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</header>

<main class="mt-20 sm:mt-32">
    <div class="min-w-screen flex items-center justify-center px-5 py-5">
        <div class="rounded overflow-hidden lg:flex">
            <div
                class="min-w-[360px] md:min-w-[500px] lg:min-w-[580px] sm:min-h-[400px] w-full flex md:w-1/2 p-10 bg-gray-900 text-gray-100 items-center justify-center">
                <div class="w-full">
                    <h3 class="text-2xl sm:text-3xl font-bold leading-tight text-gray-200" *ngIf="stockQuote">
                        {{selectedStockName}}</h3>
                    <h6 *ngIf="stockQuote" class="text-lg pb-6 sm:text-xl leading-tight mb-2">
                        <span>{{ selectedSymbol}}
                        </span>&nbsp;&nbsp;-&nbsp;&nbsp;{{ formatDate(lastRefreshedDate) }}
                    </h6>
                    <div class="flex w-full items-end mb-6">
                        <span *ngIf="stockQuote"
                            class="block leading-5 text-3xl sm:text-4xl font-semibold antialiased text-gray-200">
                            {{getCurrencySymbol(selectedStockCurrency)}}{{(+stockQuote['05. price']).toFixed(2)}}
                        </span>
                        <span *ngIf="stockQuote" class="block leading-5 text-lg sm:text-xl ml-4"
                            [ngClass]="{ 'text-red-500': stockQuote['09. change'] < 0, 'text-green-500': stockQuote['09. change'] >= 0 }">
                            <ng-container *ngIf="stockQuote['09. change'] < 0">▼</ng-container>
                            <ng-container *ngIf="stockQuote['09. change'] >= 0">▲</ng-container>
                            {{ (+stockQuote['09. change']).toFixed(3) }}
                            ({{ stockQuote['10. change percent'] }})
                        </span>
                    </div>
                    <div class="flex w-full text-sm sm:text-lg">
                        <div class="flex w-5/12">
                            <div class="flex-1 pr-3 text-left font-semibold">Open</div>
                            <div *ngIf="stockQuote" class="sm:px-3 text-right">
                                {{ (+stockQuote['02. open']).toFixed(3)
                                }}</div>
                        </div>
                        <div class="flex w-7/12">
                            <div class="flex-1 px-3 text-left font-semibold">Volume</div>
                            <div *ngIf="stockQuote" class="sm:px-3 text-right">
                                {{ (+stockQuote['06. volume']).toFixed(3) }}</div>
                        </div>
                    </div>
                    <div class="flex w-full text-sm sm:text-lg">
                        <div class="flex w-5/12">
                            <div class="flex-1 pr-3 text-left font-semibold">High</div>
                            <div *ngIf="stockQuote" class="sm:px-3 text-right">
                                {{ (+stockQuote['03. high']).toFixed(3)
                                }}</div>
                        </div>
                        <div class="flex w-7/12">
                            <div class="flex-1 px-3 text-left font-semibold">Market Open</div>
                            <div *ngIf="stockQuote" class="sm:px-3 text-right">{{ selectedStockMarketOpen }}</div>
                        </div>
                    </div>
                    <div class="flex w-full text-sm sm:text-lg">
                        <div class="flex w-5/12">
                            <div class="flex-1 pr-3 text-left font-semibold">Low</div>
                            <div *ngIf="stockQuote" class="sm:px-3 text-right">
                                {{ (+stockQuote['04. low']).toFixed(3) }}
                            </div>
                        </div>
                        <div class="flex w-7/12">
                            <div class="flex-1 px-3 text-left font-semibold">Market Close</div>
                            <div *ngIf="stockQuote" class="sm:px-3 text-right">{{ selectedStockMarketClose }}</div>
                        </div>
                    </div>
                </div>
            </div>
            <div
                class="min-w-[360px] md:min-w-[500px] lg:min-w-[580px] sm:min-h-[400px] w-full md:w-1/2 px-5 pb-4 pt-8 bg-gray-900 text-white items-center justify-center">
                <div class="flex space-x-3 items-center justify-center">
                    <span (click)="selectResult(selectedSymbol, '1min')"
                        class="px-3 py-2 cursor-pointer relative {{selectedInterval === '1min' ? 'text-blue-600' : 'text-gray-400'}}">
                        1D
                        <span
                            class="absolute left-0 bottom-0 w-full h-0.5 bg-blue-600 transition-all duration-200 ease-in-out transform origin-left scale-x-0 {{selectedInterval === '1min' ? 'scale-x-100' : 'scale-x-0'}}"></span>
                    </span>
                    <span (click)="selectResult(selectedSymbol, '30min')"
                        class="px-3 py-2 cursor-pointer relative {{selectedInterval === '30min' ? 'text-blue-600' : 'text-gray-400'}}">
                        5D
                        <span
                            class="absolute left-0 bottom-0 w-full h-0.5 bg-blue-600 transition-all duration-200 ease-in-out transform origin-left scale-x-0 {{selectedInterval === '30min' ? 'scale-x-100' : 'scale-x-0'}}"></span>
                    </span>
                    <span (click)="selectResult(selectedSymbol, 'Daily')"
                        class="px-3 py-2 cursor-pointer relative {{selectedInterval === 'Daily' ? 'text-blue-600' : 'text-gray-400'}}">
                        1M
                        <span
                            class="absolute left-0 bottom-0 w-full h-0.5 bg-blue-600 transition-all duration-200 ease-in-out transform origin-left scale-x-0 {{selectedInterval === 'Daily' ? 'scale-x-100' : 'scale-x-0'}}"></span>
                    </span>
                    <span (click)="selectResult(selectedSymbol, 'Weekly')"
                        class="px-3 py-2 cursor-pointer relative {{selectedInterval === 'Weekly' ? 'text-blue-600' : 'text-gray-400'}}">
                        1Y
                        <span
                            class="absolute left-0 bottom-0 w-full h-0.5 bg-blue-600 transition-all duration-200 ease-in-out transform origin-left scale-x-0 {{selectedInterval === 'Weekly' ? 'scale-x-100' : 'scale-x-0'}}"></span>
                    </span>
                    <span (click)="selectResult(selectedSymbol, 'Monthly')"
                        class="px-3 py-2 cursor-pointer relative {{selectedInterval === 'Monthly' ? 'text-blue-600' : 'text-gray-400'}}">
                        5Y
                        <span
                            class="absolute left-0 bottom-0 w-full h-0.5 bg-blue-600 transition-all duration-200 ease-in-out transform origin-left scale-x-0 {{selectedInterval === 'Monthly' ? 'scale-x-100' : 'scale-x-0'}}"></span>
                    </span>
                </div>
                <div class="flex justify-center items-center px-3 pb-4 pt-8">
                    <canvas id="chart" class="w-full h-full"></canvas>
                </div>
            </div>
        </div>
    </div>
    <div class="mx-8 my-24">
        <app-news></app-news>
    </div>
    <app-footer></app-footer>
</main>